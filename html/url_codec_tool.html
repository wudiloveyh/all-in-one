<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>URL ç¼–è§£ç å·¥å…· | æè‡´ä½“éªŒåˆ›æ–°ç‰ˆ</title>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --main: #1a3b5d;
            --fade: #b6dcfa;
            --accent: #fb8c00;
            --bg: #f3f7fa;
            --card: white;
            --shadow: 0 12px 40px 0 #57a7ff0f;
            --btn: #fb8c00;
            --btn-hover: #be670a;
        }

        @font-face {
            font-family: 'MyFont';
            /* è‡ªå®šä¹‰ä¸€ä¸ªå­—ä½“åç§°ï¼ˆéšæ„èµ·åï¼‰ */
            src: url('../font.ttf') format('truetype');
            /* æ ¹æ®å®é™…è·¯å¾„è°ƒæ•´ */
            font-weight: normal;
            font-style: normal;
        }

        body {
            background: linear-gradient(120deg, #e3f0ff 0%, #fbffe5 100%);
            min-height: 100vh;
            margin: 0;
            font-family: 'MyFont';
            color: var(--main);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .url-card {
            margin-top: 6vw;
            min-width: 340px;
            width: 680px;
            max-width: 98vw;
            border-radius: 34px;
            box-shadow: var(--shadow);
            background: var(--card);
            display: flex;
            flex-direction: row;
            overflow: hidden;
            transition: box-shadow .48s cubic-bezier(.3, .8, .43, 1.07), background 0.4s;
            position: relative;
        }

        .card-col {
            flex: 1 1 0;
            min-height: 360px;
            display: flex;
            flex-direction: column;
            padding: 48px 30px 38px;
            background: rgba(255, 255, 255, 0.94);
            transition: background 0.36s;
            position: relative;
        }

        .card-col:not(:last-child) {
            border-right: 1.5px solid #e2e8ef;
        }

        .card-col h2 {
            margin: 0 0 10px 0;
            font-weight: 600;
            letter-spacing: 1.5px;
            color: #e7a227;
            font-size: 1.13rem;
            display: flex;
            align-items: center;
            min-height: 28px;
        }

        .card-col .col-row {
            margin: 0 0 10px 0;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: .93em;
            color: #888;
            user-select: none;
        }

        .action-bar {
            margin-top: 18px;
            display: flex;
            gap: 16px;
            align-items: center;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: var(--btn);
            color: #fff;
            font-weight: 600;
            font-size: 1rem;
            padding: 8px 22px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            position: relative;
            box-shadow: 0 1px 10px #fb8c003a;
            overflow: hidden;
            outline: none;
            transition: background 0.21s, transform 0.35s cubic-bezier(.35, 1.3, .56, 1), box-shadow 0.27s;
        }

        .btn:hover,
        .btn:focus {
            background: var(--btn-hover);
            transform: scale(1.04) translateY(-2px);
            box-shadow: 0 4px 20px #fb8c0035;
        }

        .btn:active {
            background: #f3b357;
            color: #704200;
        }

        .btn.ripple::after {
            content: "";
            position: absolute;
            border-radius: 50%;
            left: 50%;
            top: 50%;
            width: 12px;
            height: 12px;
            background: rgba(255, 255, 255, 0.38);
            opacity: 0;
            transform: scale(1) translate(-50%, -50%);
            pointer-events: none;
            transition: all 0.6s cubic-bezier(.2, .7, .4, 1);
        }

        .btn.ripple:active::after {
            width: 120px;
            height: 120px;
            opacity: .26;
            background: rgba(255, 255, 255, 0.68);
        }

        .clear-btn {
            position: absolute;
            top: 18px;
            right: 18px;
            z-index: 2;
            background: none;
            border: none;
            color: #c6bfbf;
            font-size: 1.18em;
            cursor: pointer;
            padding: 2px 4px;
            border-radius: 6px;
            transition: color .19s, background .21s;
        }

        .clear-btn:hover,
        .clear-btn:focus {
            background: #ffeceb;
            color: #fb8c00;
        }

        textarea {
            resize: none;
            width: 100%;
            box-sizing: border-box;
            min-height: 120px;
            flex: 1 1 0;
            border: none;
            background: #f8fafd;
            border-radius: 12px;
            font-size: 1.04rem;
            padding: 16px 13px;
            line-height: 1.55;
            color: var(--main);
            box-shadow: 0 2px 14px 0 rgba(11, 60, 100, 0.035) inset;
            transition: box-shadow 0.37s, background 0.29s;
            outline: none;
            margin: 8px 0 20px;
        }

        textarea:focus {
            box-shadow: 0 6px 34px 0 #f8a85523, 0 2px 14px 0 rgba(18, 83, 100, 0.04) inset;
            background: #fff;
        }

        .copied-bar {
            font-size: 0.98em;
            margin-left: 4px;
            color: #3bc26f;
            opacity: 0;
            transition: color 0.3s, opacity 0.6s;
            pointer-events: none;
            user-select: none;
        }

        .copied-bar.active {
            opacity: 1;
            font-weight: 800;
            color: #1dc47f;
            transition: opacity 0.33s, color .1s;
        }

        .divider-v {
            width: 2.1px;
            background: linear-gradient(105deg, #fb8c00bb 0%, #ffe08288 100%);
            height: 74%;
            align-self: center;
            border-radius: 16px;
            opacity: 0.12;
            margin: 0 0 0 0;
            transition: height 0.3s;
        }

        /* åŠ¨ç”»ä¸å¸ƒå±€åˆ‡æ¢ */
        .switch-btn {
            border: none;
            outline: none;
            background: none;
            font-size: 1.2em;
            color: var(--accent);
            margin: 0 0 0 6px;
            cursor: pointer;
            border-radius: 9px;
            transition: background 0.21s, color 0.18s;
            padding: 1px 8px 1px 6px;
        }

        .switch-btn:hover,
        .switch-btn:focus {
            background: #fff5e1;
            color: #be670a;
        }

        .fade-swap {
            animation: fadeSwap 0.38s cubic-bezier(.22, 1.2, .7, 1.05);
        }

        @keyframes fadeSwap {
            0% {
                opacity: 0.7;
                transform: scaleX(0.96) translateY(18px);
            }

            80% {
                opacity: 0.97;
                transform: scale(1.02);
            }

            100% {
                opacity: 1;
                transform: none;
            }
        }

        /* æ¸…ç©ºåŠ¨ç”» */
        .cleared-anim {
            animation: cleared 0.35s cubic-bezier(.22, .94, .64, 1.22);
        }

        @keyframes cleared {
            0% {
                background: #ffe2b7;
            }

            65% {
                background: #ffe2b7;
            }

            100% {
                background: #f8fafd;
            }
        }

        /* é”™è¯¯åŠ¨ç”» */
        .error-anim {
            animation: errorWiggle 0.36s cubic-bezier(.4, 1.23, .77, 1.27);
            background: #fff8e9 !important;
            border: 1.5px solid #fe5881 !important;
        }

        @keyframes errorWiggle {
            0% {
                transform: translateX(0);
            }

            23% {
                transform: translateX(-7px);
            }

            48% {
                transform: translateX(7px);
            }

            73% {
                transform: translateX(-5px);
            }

            100% {
                transform: translateX(0);
            }
        }

        .tip {
            font-size: .94em;
            color: #bfa454;
            margin-top: 15px;
            text-align: left;
            line-height: 1.45;
            font-weight: 450;
            letter-spacing: .2px;
        }

        @media (max-width: 720px) {
            .url-card {
                flex-direction: column;
                width: 99vw;
                min-width: 120px;
            }

            .card-col {
                padding: 24px 4vw 16px;
            }

            .divider-v {
                width: 65vw;
                height: 2.4px;
                min-height: 12px;
                margin: 16px 0 0 0;
            }
        }

        @media (max-width: 420px) {
            .url-card {
                border-radius: 13px;
                margin-top: 10px;
            }

            .card-col {
                padding: 8vw 2vw 14vw;
            }
        }
    </style>
</head>

<body>
    <div class="url-card" id="urlCard">
        <!-- ç¼–ç åŒº/è§£ç åŒºï¼ˆå·¦ï¼Œå¯äº¤æ¢é¡ºåºï¼‰ -->
        <section class="card-col" id="inputCol">
            <button class="clear-btn" id="clearInput" aria-label="æ¸…ç©ºè¾“å…¥" title="æ¸…ç©ºè¾“å…¥">âœ•</button>
            <h2 id="inputLabel">åŸå§‹å†…å®¹ï¼ˆè‡ªåŠ¨URLç¼–ç ï¼‰</h2>
            <div class="col-row">
                <span id="inputMode">ç¼–ç </span>
                <button class="switch-btn" id="swapBtn" title="åˆ‡æ¢æ–¹å‘">â‡„ åˆ‡æ¢</button>
            </div>
            <textarea id="inputArea" placeholder="è¾“å…¥å†…å®¹ï¼Œå¦‚ï¼šhttps://domain.com/ä½ å¥½.html?xx=å¼ ä¸‰" aria-label="åŸæ–‡"></textarea>
            <div class="action-bar">
                <button class="btn ripple" id="encodeBtn">ç¼–ç  â–¶ï¸</button>
            </div>
        </section>
        <aside class="divider-v"></aside>
        <!-- ç¼–ç ç»“æœ/è§£ç ç»“æœåŒº -->
        <section class="card-col" id="outputCol">
            <button class="clear-btn" id="clearOutput" aria-label="æ¸…ç©ºè¾“å‡º" title="æ¸…ç©ºè¾“å‡º">âœ•</button>
            <h2 id="outputLabel">ç¼–ç ç»“æœï¼ˆè‡ªåŠ¨è§£ç ï¼‰</h2>
            <div class="col-row">
                <span id="outputMode">è§£ç </span>
                <span class="copied-bar" id="copyMark">å·²å¤åˆ¶ï¼</span>
            </div>
            <textarea id="outputArea" placeholder="è‡ªåŠ¨è·å¾— URL ç¼–ç ç»“æœ" readonly aria-readonly="true"></textarea>
            <div class="action-bar">
                <button class="btn ripple" id="copyBtn" title="å¤åˆ¶ç»“æœ">ğŸ“‹ å¤åˆ¶</button>
            </div>
        </section>
    </div>
    <script>
        // è·å–DOM
        const inputArea = document.getElementById('inputArea');
        const outputArea = document.getElementById('outputArea');
        const encodeBtn = document.getElementById('encodeBtn');
        const copyBtn = document.getElementById('copyBtn');
        const swapBtn = document.getElementById('swapBtn');
        const inputLabel = document.getElementById('inputLabel');
        const outputLabel = document.getElementById('outputLabel');
        const inputMode = document.getElementById('inputMode');
        const outputMode = document.getElementById('outputMode');
        const copyMark = document.getElementById('copyMark');
        const clearInput = document.getElementById('clearInput');
        const clearOutput = document.getElementById('clearOutput');
        const urlCard = document.getElementById('urlCard');

        // çŠ¶æ€æ§åˆ¶
        let encodeDirect = true;  // true=ç¼–ç æ¨¡å¼ï¼Œfalse=è§£ç æ¨¡å¼
        let isSyncing = false;

        // ç¼–ç è§£ç å‡½æ•°
        function urlEncode(str) {
            try {
                return encodeURIComponent(str)
            } catch (e) {
                return '';
            }
        }
        function urlDecode(str) {
            try {
                return decodeURIComponent(str)
            } catch (e) {
                return null;
            }
        }

        // è”åŠ¨åŒæ­¥å¤„ç†
        function syncRealtime() {
            if (isSyncing) return;
            isSyncing = true;
            let input = inputArea.value;
            let out = '';
            if (encodeDirect) {  // ç¼–ç 
                if (!input) {
                    outputArea.value = '';
                    outputArea.classList.remove('error-anim');
                } else {
                    try {
                        out = urlEncode(input);
                        outputArea.value = out;
                        outputArea.classList.remove('error-anim');
                    } catch {
                        outputArea.value = '';
                        outputArea.classList.add('error-anim');
                    }
                }
            } else {            // è§£ç 
                if (!input) {
                    outputArea.value = '';
                    inputArea.classList.remove('error-anim');
                    outputArea.classList.remove('error-anim');
                } else {
                    let dec = urlDecode(input);
                    if (dec === null) {
                        outputArea.value = '[è§£ç å¤±è´¥] éæ³•URLç¼–ç ';
                        outputArea.classList.add('error-anim');
                        inputArea.classList.add('error-anim');
                    } else {
                        outputArea.value = dec;
                        outputArea.classList.remove('error-anim');
                        inputArea.classList.remove('error-anim');
                    }
                }
            }
            isSyncing = false;
        }

        // è¾“å…¥äº‹ä»¶
        inputArea.addEventListener('input', syncRealtime);

        // æŒ‰é’®ç¼–è§£ç 
        encodeBtn.addEventListener('click', () => {
            syncRealtime();
            outputArea.classList.add('fade-swap');
            setTimeout(() => { outputArea.classList.remove('fade-swap') }, 340);
            outputArea.focus();
            outputArea.select();
        });

        // å¤åˆ¶
        copyBtn.addEventListener('click', () => {
            outputArea.select();
            document.execCommand('copy');
            copyMark.classList.add('active');
            setTimeout(() => copyMark.classList.remove('active'), 1050);
        });

        // åˆ‡æ¢æ–¹å‘
        swapBtn.addEventListener('click', () => {
            encodeDirect = !encodeDirect;
            // äº¤æ¢æ ‡é¢˜ä¸placeholderä¸æ¨¡å¼æŒ‡ç¤º
            if (encodeDirect) {
                inputLabel.textContent = 'åŸå§‹å†…å®¹ï¼ˆè‡ªåŠ¨URLç¼–ç ï¼‰';
                outputLabel.textContent = 'ç¼–ç ç»“æœï¼ˆè‡ªåŠ¨è§£ç ï¼‰';
                inputArea.placeholder = 'è¾“å…¥å†…å®¹ï¼Œå¦‚ï¼šhttps://www.domain.com/ä¸­æ–‡?x=å¼ ä¸‰';
                outputArea.placeholder = 'è‡ªåŠ¨è·å¾— URL ç¼–ç ç»“æœ';
                inputMode.textContent = 'ç¼–ç ';
                outputMode.textContent = 'è§£ç ';
                encodeBtn.textContent = 'ç¼–ç  â–¶ï¸';
            } else {
                inputLabel.textContent = 'åŸå§‹å†…å®¹ï¼ˆè‡ªåŠ¨URLè§£ç ï¼‰';
                outputLabel.textContent = 'è§£ç ç»“æœï¼ˆè‡ªåŠ¨ç¼–ç ï¼‰';
                inputArea.placeholder = 'è¾“å…¥URLç¼–ç å†…å®¹ï¼Œå¦‚ï¼š%E5%BC%A0%E4%B8%89';
                outputArea.placeholder = 'è‡ªåŠ¨è·å¾— URL è§£ç åŸæ–‡';
                inputMode.textContent = 'è§£ç ';
                outputMode.textContent = 'ç¼–ç ';
                encodeBtn.textContent = 'è§£ç  â–¶ï¸';
            }
            // åŠ¨ç”»
            inputArea.classList.add('fade-swap');
            outputArea.classList.add('fade-swap');
            setTimeout(() => {
                inputArea.classList.remove('fade-swap');
                outputArea.classList.remove('fade-swap');
            }, 340);
            // è‡ªåŠ¨åˆ·æ–°
            syncRealtime();
        });

        // æ¸…ç©ºè¾“å…¥è¾“å‡º
        function clearTextarea(ele) {
            ele.value = '';
            ele.classList.remove('cleared-anim');
            void ele.offsetWidth;
            ele.classList.add('cleared-anim');
            setTimeout(() => ele.classList.remove('cleared-anim'), 440);
            syncRealtime();
        }
        clearInput.addEventListener('click', () => {
            clearTextarea(inputArea);
            inputArea.focus();
        });
        clearOutput.addEventListener('click', () => {
            clearTextarea(outputArea);
            outputArea.blur();
        });

        // ç²˜è´´æ–‡ä»¶å†…å®¹ç›´æ¥è¯»åˆ°è¾“å…¥æ¡†
        inputArea.addEventListener('paste', function (e) {
            const items = (e.clipboardData || window.clipboardData).items;
            for (let i = 0; i < items.length; i++) {
                if (items[i].kind === 'file') {
                    e.preventDefault();
                    const file = items[i].getAsFile();
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function (evt) {
                            inputArea.value = evt.target.result;
                            syncRealtime();
                        }
                        reader.readAsText(file, 'utf-8');
                    }
                }
            }
        });

        // é€‰ä¸­è‡ªåŠ¨ç¼–/è§£ç 
        window.onload = () => {
            inputArea.value = '';
            outputArea.value = '';
            inputArea.placeholder = 'è¾“å…¥å†…å®¹ï¼Œå¦‚ï¼šhttps://domain.com/ä½ å¥½.html?xx=å¼ ä¸‰';
            outputArea.placeholder = 'è‡ªåŠ¨è·å¾— URL ç¼–ç ç»“æœ';
            encodeDirect = true;
            syncRealtime();
        };
    </script>
</body>

</html>