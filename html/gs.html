<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>GitHub æœç´¢åŠ©æ‰‹</title>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <style>
        @font-face {
            font-family: 'MyFont';
            /* è‡ªå®šä¹‰ä¸€ä¸ªå­—ä½“åç§°ï¼ˆéšæ„èµ·åï¼‰ */
            src: url('../font.ttf') format('truetype');
            /* æ ¹æ®å®é™…è·¯å¾„è°ƒæ•´ */
            font-weight: normal;
            font-style: normal;
        }

        body {
            font-family: MyFont, 'åæ–‡ä»¿å®‹';
            max-width: 900px;
            margin: 20px auto;
            padding: 20px;
            background-color: #e0e0e0;
            border-radius: 10px;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
        }

        input,
        select,
        button {
            padding: 8px 12px;
            font-size: 14px;
        }

        button {
            border-radius: 30px;
            font-family: inherit;
            border: none;
            cursor: pointer;
            transition: all .3s ease;
        }

        button:hover {
            box-shadow: 3px 3px 2px #7BA4B8;
        }

        ul {
            list-style: none;
            padding: 0;
            margin-top: 20px;
        }

        li {
            background: #fff;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        li:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        a {
            color: #007bff;
            font-weight: bold;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        p {
            margin: 5px 0;
            color: #555;
        }

        #message {
            text-align: center;
            color: #d9534f;
            font-weight: bold;
            margin-top: 10px;
        }

        #hint {
            text-align: center;
            color: #333;
            font-size: 0.9em;
            margin-top: 5px;
        }

        #pagination {
            display: none;
            margin-top: 20px;
            text-align: center;
        }

        #pagination.show {
            display: block;
        }

        #pagination button {
            margin: 0 5px;
        }

        #pagination span {
            font-weight: bold;
        }

        /* ä¼˜åŒ–è¡¨å•æ ·å¼ */
        .form-row {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .form-row input,
        .form-row select {
            flex: 1 0 200px;
        }

        .form-row button {
            flex: 0 0 100px;
        }

        .form-row-optional {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .form-row-optional input {
            flex: 1 0 150px;
        }
    </style>
</head>

<body>

    <h1>GitHub æœç´¢åŠ©æ‰‹</h1>

    <!-- ä¸»æœç´¢è¡Œ -->
    <div class="form-row">
        <input type="text" id="keyword" placeholder="è¯·è¾“å…¥å…³é”®å­—" />
        <select id="syntax">
            <option value="">--æœç´¢æ¨¡æ¿--</option>
            <option value="repo:{input}">repo:ç”¨æˆ·/ä»“åº“</option>
            <option value="user:{input}">user:ç”¨æˆ·å</option>
            <option value="in:file {input}">æ–‡ä»¶å†…å®¹æœç´¢</option>
        </select>
        <button id="searchBtn">æœç´¢</button>
    </div>

    <!-- å¯é€‰æ¡ä»¶è¡Œ -->
    <div class="form-row-optional">
        <input type="number" id="minStars" placeholder="æœ€å°‘ Star" min="0" />
        <input type="number" id="minForks" placeholder="æœ€å°‘ Fork" min="0" />
    </div>

    <div id="message"></div>
    <div id="hint">é»˜è®¤æŒ‰ä»“åº“åç§°/æè¿°æœç´¢</div>

    <ul id="results"></ul>

    <div id="pagination">
        <button id="prevBtn">ä¸Šä¸€é¡µ</button>
        <span id="pageInfo">ç¬¬ 1 é¡µ</span>
        <button id="nextBtn">ä¸‹ä¸€é¡µ</button>
    </div>

    <script>
        const searchBtn = document.getElementById("searchBtn");
        const results = document.getElementById("results");
        const pagination = document.getElementById("pagination");
        const message = document.getElementById("message");
        const hint = document.getElementById("hint");
        const syntaxSelect = document.getElementById("syntax");
        const keywordInput = document.getElementById("keyword");
        const minStarsInput = document.getElementById("minStars");
        const minForksInput = document.getElementById("minForks");

        let currentPage = 1;
        let lastQuery = "";

        const updateHint = () => {
            const syntaxTemplate = syntaxSelect.value;
            if (!syntaxTemplate) {
                hint.textContent = "é»˜è®¤æŒ‰ä»“åº“åç§°/æè¿°æœç´¢";
            } else if (syntaxTemplate.startsWith("repo")) {
                hint.textContent = "æŒ‰æŒ‡å®šç”¨æˆ·/ä»“åº“æœç´¢";
            } else if (syntaxTemplate.startsWith("user")) {
                hint.textContent = "æŒ‰æŒ‡å®šç”¨æˆ·æœç´¢ä»“åº“";
            } else if (syntaxTemplate.startsWith("in:file")) {
                hint.textContent = "æŒ‰æ–‡ä»¶å†…å®¹æœç´¢";
            }
        };

        syntaxSelect.addEventListener("change", updateHint);
        keywordInput.addEventListener("input", updateHint);

        const buildQuery = () => {
            let query = syntaxSelect.value ? syntaxSelect.value.replace("{input}", keywordInput.value.trim()) : keywordInput.value.trim();

            if (minStarsInput.value) query += ` stars:>=${minStarsInput.value}`;
            if (minForksInput.value) query += ` forks:>=${minForksInput.value}`;

            return query;
        };

        const updateResults = async (query, page = 1) => {
            message.textContent = "";
            results.innerHTML = "<li>æ­£åœ¨æœç´¢...</li>";
            pagination.classList.remove("show");

            try {
                const url = `https://api.github.com/search/repositories?q=${encodeURIComponent(query)}&per_page=10&page=${page}`;
                const res = await fetch(url);
                if (!res.ok) throw new Error(`GitHub API é”™è¯¯: ${res.status}`);
                const data = await res.json();

                results.innerHTML = "";
                if (!data.items || data.items.length === 0) {
                    results.innerHTML = "<li>æœªæ‰¾åˆ°ç›¸å…³ç»“æœ</li>";
                    return;
                }

                data.items.forEach(item => {
                    const li = document.createElement("li");
                    li.innerHTML = `
                        <a href="${item.html_url}" target="_blank">${item.full_name}</a>
                        <p>${item.description || "æ— æè¿°"}</p>
                        <p>â­ ${item.stargazers_count} | ğŸ“ ${item.language || "æœªçŸ¥è¯­è¨€"}</p>
                    `;
                    results.appendChild(li);
                });

                document.getElementById("pageInfo").textContent = `ç¬¬ ${page} é¡µ`;
                pagination.classList.add("show");
            } catch (err) {
                results.innerHTML = "";
                message.textContent = `æœç´¢å¤±è´¥: ${err.message}`;
            }
        };

        searchBtn.addEventListener("click", () => {
            if (!keywordInput.value.trim()) {
                message.textContent = "è¯·è¾“å…¥å…³é”®å­—ï¼";
                results.innerHTML = "";
                pagination.classList.remove("show");
                return;
            }
            lastQuery = buildQuery();
            currentPage = 1;
            updateResults(lastQuery, currentPage);
        });

        document.getElementById("prevBtn").addEventListener("click", () => {
            if (currentPage > 1) {
                currentPage--;
                updateResults(lastQuery, currentPage);
            }
        });

        document.getElementById("nextBtn").addEventListener("click", () => {
            currentPage++;
            updateResults(lastQuery, currentPage);
        });

        updateHint();
    </script>

</body>

</html>